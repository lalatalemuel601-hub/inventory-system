<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory system</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- NAV SIDEBAR -->
    <nav class="icon-nav">
        <div class="nav-icon active" onclick="switchView('overview')" title="Overview Home">üè†</div>
        <div class="nav-icon" onclick="switchView('dashboard')" title="Projects Dashboard">üìÇ</div>
        <div class="nav-icon" onclick="switchView('warehouse')" title="Inventory Monitor">üè¢</div>
        <div class="nav-icon" onclick="switchView('records')" title="Reports">üìä</div>
        <!-- Idagdag ito sa ilalim ng üìä Reports icon -->
<div class="nav-icon" onclick="switchView('reflection')" title="Reflection / Cost Analysis">üìà</div>
    </nav>

    <!-- MAIN CONTAINER -->
    <div class="main-container">

        <!-- PRINT HEADER (Only visible on print) -->
        <div class="print-header">
            <div>
                <h1 style="font-size:24px; margin:0;">inventory Report</h1>
                <small>kayelens construction</small>
            </div>
            <div style="text-align:right;">
                <p id="print-date">Date: </p>
            </div>
        </div>

        <!-- VIEW 0: OVERVIEW -->
        <div id="view-overview" class="view-section active">
            <div class="overview-container">
                <div class="header-flex">
                    <div>
                        <h2>Company Overview</h2>
                        <small style="color:var(--text-light)">Real-time business insights</small>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="btn btn-sec" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
                        <button class="btn btn-pri" onclick="switchView('dashboard')">Go to Projects &rarr;</button>
                    </div>
                </div>

                <!-- KPI CARDS -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <small>Active Projects</small>
                        <h2 id="ov-active-proj">0</h2>
                    </div>
                    <div class="kpi-card">
                        <small>Warehouse Value</small>
                        <h2 id="ov-stock-val" class="text-green">‚Ç±0</h2>
                    </div>
                    <div class="kpi-card">
                        <small>Total Expenses</small>
                        <h2 id="ov-total-exp" class="text-orange">‚Ç±0</h2>
                    </div>
                    <div class="kpi-card" style="border-left: 4px solid var(--primary);">
                        <small>Net Remaining Fund</small>
                        <h2 id="ov-net-fund">‚Ç±0</h2>
                    </div>
                </div>

                <!-- ALERT / ACTION CENTER -->
                <div class="action-center">
                    <h3 style="margin-bottom:15px;">‚ö†Ô∏è System Alerts</h3>
                    <div id="alert-feed"></div>
                </div>

                <!-- RECENT ACTIVITY -->
                <div class="card">
                    <h3 style="margin-bottom:15px;">Recent Transactions</h3>
                    <table>
                        <thead><tr><th>Date</th><th>Type</th><th>Item</th><th>Amount</th><th>Ref</th></tr></thead>
                        <tbody id="ov-recent-tbl"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- VIEW 1: PROJECT DASHBOARD -->
        <div id="view-dashboard" class="view-section">
            <div class="dashboard-grid">
                <!-- Left: List -->
                <div class="list-col">
                    <div style="padding:20px; border-bottom:1px solid #eee;">
                        <h3 style="margin-bottom:10px;">Active Projects</h3>
                        <input type="text" id="search-proj" placeholder="Search..." onkeyup="renderProjectList()" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:6px;">
                    </div>
                    <div id="project-list-container" style="flex:1;"></div>
                    <div style="padding:15px; border-top:1px solid #eee;">
                        <button class="btn btn-pri" style="width:100%" onclick="openModal('modal-add-proj')">+ New Project</button>
                    </div>
                </div>
                <!-- Right: Details -->
                <div class="details-col" id="project-details-panel">
                    <div style="text-align:center; margin-top:100px; color:var(--text-light);">
                        <p>Select a project from the list to view analytics.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: WAREHOUSE -->
        <div id="view-warehouse" class="view-section" style="padding:30px;">
            <div class="header-flex">
                <h2>üè¢ Inventory Monitor</h2>
                <div>
                    <button class="btn btn-sec" onclick="window.print()">üñ®Ô∏è Print List</button>
                    <button class="btn" onclick="openBatchModal('IN')">üì¶ Batch Receive</button>
                </div>
            </div>
            <!-- Ilagay ito sa loob ng Inventory View container, sa taas ng table -->
<div style="display:flex; gap:10px; margin-bottom:15px;">
    <select id="filter-cat" class="inp" onchange="renderWarehouse()" style="width:150px;">
        <option>All</option>
        <option>Hardware</option>
        <option>Electrical</option>
        <option>Plumbing</option>
        <option>Paint</option>
    </select>
    <!-- Ito ang BAGONG Search Bar -->
    <input type="text" id="search-warehouse" class="inp" placeholder="üîç Search Item..." onkeyup="renderWarehouse()" style="flex:1;">
</div>
            <table>
                <thead><tr><th>Category</th><th>Item</th><th>On Hand</th><th>Unit Value</th><th>Total Value</th><th>Status</th><th>Actions</th></tr></thead>
                <tbody id="tbl-warehouse"></tbody>
            </table>
        </div>

<!-- VIEW 3: REPORT CENTER -->
<div id="view-records" class="view-section" style="padding:30px;">
    
    <!-- SECTION A: SELECTION MENU (Calendar Look) -->
    <div id="rep-menu-interface">
        <div class="header-flex">
            <h2>üìÖ Reports Center</h2>
        </div>
        
        <!-- Breadcrumb navigation -->
        <div id="rep-breadcrumb" class="breadcrumb" style="font-size:1.2rem; margin-bottom:20px;"></div>
        
        <!-- Dito lalabas ang mga Years / Months / Weeks buttons -->
        <div id="rep-selection-grid" class="cal-grid"></div>
    </div>

    <!-- SECTION B: FINAL REPORT (Hidden, appears only for Printing) -->
    <div id="report-print-area" style="display:none;">
        
        <!-- Controls (Back / Print) -->
        <div class="header-flex no-print" style="margin-bottom:20px; border-bottom:1px solid #ddd; padding-bottom:10px;">
            <button class="btn btn-sec" onclick="resetReportView()">‚Üê Back to Selections</button>
            <button class="btn btn-pri" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
        </div>

        <!-- Official Report Header -->
        <div style="text-align:center; margin-bottom:20px;">
            <h1 style="margin:0; text-transform:uppercase;">Weekly Transaction Report</h1>
            <p id="rep-period-text" style="margin:5px 0;">Period: --</p>
        </div>

        <!-- Professional Table List -->
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Category</th>
                    <th>Item Name</th>
                    <th>Ref / Project</th>
                    <th>Qty</th>
                    <th>Unit Cost</th>
                    <th>Total Amount</th>
                </tr>
            </thead>
            <tbody id="rep-table-body">
                <!-- Data injected here -->
            </tbody>
            <tfoot>
                <tr style="background:#f3f4f6; font-weight:bold;">
                    <td colspan="7" style="text-align:right;">TOTAL IN (Added Value):</td>
                    <td id="rep-total-in">0.00</td>
                </tr>
                <tr style="background:#f3f4f6; font-weight:bold;">
                    <td colspan="7" style="text-align:right;">TOTAL OUT (Expenses):</td>
                    <td id="rep-total-out" style="color:red;">0.00</td>
                </tr>
            </tfoot>
        </table>

        <!-- Signatures -->
        <div style="margin-top:40px; display:flex; justify-content:space-between; page-break-inside: avoid;">
            <div style="text-align:center;">
                <p>Prepared by:</p>
                <br><br>____________________<br>Admin
            </div>
            <div style="text-align:center;">
                <p>Verified by:</p>
                <br><br>____________________<br>warehouse manager
            </div>
        </div>
    </div>
</div>

</div>
    
    <!-- Print Button (Visible only when report is shown) -->
    <div id="rep-actions" style="margin-top:20px; display:none; justify-content:flex-end;">
        <button class="btn btn-sec" onclick="resetReportView()">Back to Menu</button>
        <button class="btn btn-pri" style="margin-left:10px;" onclick="printLegalReport()">üñ®Ô∏è Print / Save PDF (Legal)</button>
    </div>

</div>

    <!-- VIEW 5: REFLECTION (Cost & Profit Analysis) -->
<div id="view-reflection" class="view-section" style="display:none; padding:30px;">
    <!-- Ilagay ito sa taas ng Reflection Table -->
<div style="margin-bottom:15px;">
    <input type="text" id="search-ref" class="inp" placeholder="üîç Search Analysis..." onkeyup="renderReflection()" style="width:100%; max-width:300px;">
</div>
    <div class="header-flex">
        <div>
            <h1>üìà Reflection (Cost vs Profit)</h1>
            <p style="color:gray;">Monitoring ng Puhunan (IN) vs. Kinita (OUT) per Material.</p>
        </div>
        <button class="btn btn-pri" onclick="window.print()">üñ®Ô∏è Print Analysis</button>
    </div>

    <!-- Summary Cards -->
    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:20px; margin-bottom:30px;">
        <div class="card" style="border-left:5px solid blue; padding:15px; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
            <h4 style="margin:0; color:gray;">Total Investment (Stock)</h4>
            <h2 id="ref-total-invest" style="margin:5px 0; color:blue;">‚Ç±0.00</h2>
            <small>Halaga ng biniling materials</small>
        </div>
        <div class="card" style="border-left:5px solid green; padding:15px; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
            <h4 style="margin:0; color:gray;">Total Gross Sales</h4>
            <h2 id="ref-total-rev" style="margin:5px 0; color:green;">‚Ç±0.00</h2>
            <small>Halaga ng nabenta/nagamit</small>
        </div>
        <div class="card" style="border-left:5px solid gold; padding:15px; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
            <h4 style="margin:0; color:gray;">Est. Net Profit</h4>
            <h2 id="ref-net-profit" style="margin:5px 0;">‚Ç±0.00</h2>
            <small>Tubong kinita sa mga nailabas na</small>
        </div>
    </div>

    <!-- The Analysis Table -->
    <div style="overflow-x:auto; background:white; padding:10px; border-radius:8px; border:1px solid #ddd;">
        <table style="width:100%; border-collapse:collapse; font-size:0.9rem;">
            <thead>
                <tr style="background:#f3f4f6; text-align:left;">
                    <th style="padding:10px; border-bottom:2px solid #ddd;">Item Name</th>
                    
                    <!-- IN COLUMNS -->
                    <th style="padding:10px; color:blue; border-bottom:2px solid blue;">Qty Bought</th>
                    <th style="padding:10px; color:blue; border-bottom:2px solid blue;">Avg. Buy Price</th>
                    
                    <!-- OUT COLUMNS -->
                    <th style="padding:10px; color:green; border-bottom:2px solid green;">Qty Sold</th>
                    <th style="padding:10px; color:green; border-bottom:2px solid green;">Avg. Sell Price</th>
                    
                    <!-- RESULT -->
                    <th style="padding:10px; color:#b45309; border-bottom:2px solid #b45309;">Profit/Loss</th>
                </tr>
            </thead>
            <tbody id="reflection-table-body">
                <!-- Javascript will put data here -->
            </tbody>
        </table>
    </div>
</div>
    

    <!-- MODALS (Hidden on Print) -->
    <div id="modal-receive" class="modal-overlay">
        <div class="modal-box">
            <h3>üì• Receive Stock</h3>
            <div class="form-group"><label>Category</label><select id="in-cat"><option value="Construction">Construction</option><option value="Electrical">Electrical</option><option value="Plumbing">Plumbing</option><option value="Others">Others</option></select></div>
            <div class="form-group"><label>Item</label><input id="in-item"></div>
            <div class="form-group"><label>Qty</label><input id="in-qty" type="number"></div>
            <div class="form-group"><label>Price (‚Ç±)</label><input id="in-price" type="number"></div>
            <div style="display:flex; gap:10px;"><button class="btn btn-sec" style="flex:1" onclick="closeModals()">Cancel</button><button class="btn btn-pri" style="flex:1" onclick="processTransaction('IN')">Save</button></div>
        </div>
    </div>

    <div id="modal-deploy" class="modal-overlay">
        <div class="modal-box">
            <h3>üì§ Deploy to Project</h3>
            <p id="deploy-proj-name" class="text-primary" style="margin-bottom:15px; font-weight:bold;"></p>
            <div class="form-group"><label>Item</label><input id="out-item"></div>
            <div class="form-group"><label>Qty</label><input id="out-qty" type="number"></div>
            <div class="form-group"><label>Cost Allocation (‚Ç±)</label><input id="out-price" type="number"></div>
            <div style="display:flex; gap:10px;"><button class="btn btn-sec" style="flex:1" onclick="closeModals()">Cancel</button><button class="btn btn-pri" style="flex:1" onclick="processTransaction('OUT')">Save</button></div>
        </div>
    </div>

    <div id="modal-add-proj" class="modal-overlay">
        <div class="modal-box">
            <h3>New Project</h3>
            <div class="form-group"><label>Name</label><input id="np-name"></div>
            <div class="form-group"><label>Budget</label><input id="np-budget" type="number"></div>
            <div class="form-group"><label>Deadline</label><input id="np-date" type="date"></div>
            <button class="btn btn-pri" style="width:100%" onclick="saveProject()">Create</button>
            <button class="btn btn-sec" style="width:100%; margin-top:10px;" onclick="closeModals()">Cancel</button>
        </div>
    </div>

    <!-- 1. Passcode Verification Modal -->
<div id="modal-auth" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <h3>üîí Security Check</h3>
        <p>Enter Admin Passcode to proceed:</p>
        <input type="password" id="auth-input" class="inp" placeholder="Enter Code (Default: 1234)">
        <div class="modal-actions">
            <button class="btn btn-red" onclick="closeModals()">Cancel</button>
            <button class="btn" onclick="verifyPasscode()">Confirm</button>
        </div>
    </div>
</div>

<!-- 2. Edit Project Modal -->
<div id="modal-edit-proj" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <h3>‚úèÔ∏è Edit Project Details</h3>
        <input type="text" id="edit-p-name" class="inp" placeholder="Project Name">
        <input type="number" id="edit-p-budget" class="inp" placeholder="Budget Amount">
        <input type="date" id="edit-p-date" class="inp">
        <div class="modal-actions">
            <button class="btn btn-red" onclick="closeModals()">Cancel</button>
            <button class="btn" onclick="saveEditedProject()">Save Changes</button>
        </div>
    </div>
</div>
<!-- BATCH RECEIVE MODAL (Warehouse) -->
<div id="modal-batch-in" class="modal-overlay" style="display:none;">
    <div class="modal-box" style="max-width: 600px;">
        <h3>üì¶ Batch Receive Stocks</h3>
        <div id="batch-in-container" style="max-height: 300px; overflow-y: auto; margin-bottom: 10px;">
            <!-- Dito lilitaw ang mga rows -->
        </div>
        <button class="btn btn-sec" onclick="addBatchRow('IN')" style="width:100%">+ Add Item Row</button>
        <div class="modal-actions" style="margin-top: 15px;">
            <button class="btn btn-red" onclick="closeModals()">Cancel</button>
            <button class="btn" onclick="saveBatchTransaction('IN')">Save All</button>
        </div>
    </div>
</div>

<!-- BATCH DEPLOY MODAL (Project) -->
<div id="modal-batch-out" class="modal-overlay" style="display:none;">
    <div class="modal-box" style="max-width: 600px;">
        <h3>üèóÔ∏è Batch Deploy to Project</h3>
        <p id="batch-project-name" style="color:var(--main); font-weight:bold;"></p>
        <div id="batch-out-container" style="max-height: 300px; overflow-y: auto; margin-bottom: 10px;">
            <!-- Dito lilitaw ang mga rows -->
        </div>
        <button class="btn btn-sec" onclick="addBatchRow('OUT')" style="width:100%">+ Add Item Row</button>
        <div class="modal-actions" style="margin-top: 15px;">
            <button class="btn btn-red" onclick="closeModals()">Cancel</button>
            <button class="btn" onclick="saveBatchTransaction('OUT')">Deploy All</button>
        </div>
    </div>
</div>
<!-- Dito ilalagay ng script ang mga items na may stock -->
<datalist id="inventory-list"></datalist>
<script src="script.js"></script>
</body>
</html>